[tox]
envlist =
    py{36,37,38,39}-test{,-devastropy}{,-cov}
requires =
    setuptools >= 30.3.0
    pip >= 19.3.1
    tox-pypi-filter >= 0.12
isolated_build = true

[testenv]
# Pass through the following environment variables which are needed for the CI
#passenv = HOME WINDIR CI
# Run the tests in a temporary directory to make sure that we don't import
# astropy from the source tree
changedir = .tmp/{envname}
description = Run tests.
deps =
   scikit-learn<0.24
   numpy<1.20
   devastropy: git+https://github.com/astropy/astropy.git#egg=astropy
extras =
    test
commands =
    pip freeze
    #!cov: pytest {toxinidir}/astroML {toxinidir}/docs {posargs}
    !cov: pytest {toxinidir}/astroML {posargs}
    cov:  pytest {toxinidir}/astroML --cov {toxinidir}/astroML{posargs}
    #cov: coverage xml -o {toxinidir}/coverage.xml

[testenv:codestyle]
changedir = {toxinidir}
skip_install = true
description = Code style checks.
extras=
    codestyle
deps =
    flake8
commands =
    flake8 {toxinidir}/astroML

[testenv:build_docs]
changedir = {toxinidir}
description = Runs the documentation tests.
extras = docs
requires =
    sphinx
commands =
    pip freeze
    make -C doc html

#[testenv:codestyle]
